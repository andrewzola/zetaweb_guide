# Статусы строк заказов

Данная система разработана **для учета состояния каждой номенклатурной позиции заказа.**

{% hint style="info" %}
_Система статусов строк заказов работает только с конфигурацией 1С: Управление торговлей ред. 10.3._
{% endhint %}

При записи каждого документа Заказ покупателя, создаются элементы справочника «Строки заказа», строки заказа сворачиваются по номенклатуре, характеристике, цене.

#### Zeta Web 2.x



Основное место работы со статусной системой, это **обработка «Журнал строк заказов»** **(Zeta Web → Статусы строк заказа).**

![](<../.gitbook/assets/image (32).png>)

#### Условно форму обработки можно разделить на 4 части:

1. Область отборов**;**
2. Список статусов   . Данный список сформирован на основании элементов справочника "Статусы строки заказа";
3. Журнал строк;
4. Текущие статусы / история по строке заказа;

**Область отборов:** \
можно использовать отбор по Покупателю, Складу продажи, Номенклатуре и Заказу покупателя.

![](<../.gitbook/assets/image (377).png>)

**Список статусов:**\
данный список сформирован на основании элементов справочника "Статусы строки заказа".

![](<../.gitbook/assets/image (414).png>)

![](<../.gitbook/assets/image (203).png>)

Все элементы справочника предопределены, т.к. движения из статуса в статус происходят программно. Основные реквизиты карточки:

* **Код** – порядок статусов;
* **Наименование** – наименование в журнале строк;
* **Сайт наименование** – наименование статуса на сайте;
* **Веб-цвет** – подсветка строки в Журнале на сайте (если используется при верстке);
* **Описание** и **Аббревиатура** – дополнительные информационные поля для сайта;
* **Не отображать в журнале** – отображение в журнале строк на стороне 1С;
* **Сайт не отображать в журнале** – отображение в журнале строк на стороне сайта;
* **Сайт использовать один вид движения** – означает, что статус является конечным;
* **Разрешен возврат и отказ** – настройка статусов для работы с [модулем "Возвраты и отказы"](vozvraty-i-otkazy.md).

**В верхней таблице** отображаются данные из регистра сведений «Строки заказов журнал», отбор выбранных статусов происходит следующим образом, в журнале присутствует ресурс «перечень статусов строкой» - это текстовое представление конечных статусов данной строки (перечисление кодов справочника), соответственно во время отбора происходит поиск кода выбранного статуса в данной строке.

**В нижней части** журнала представлена панель закладок с таблицами, в которой отображаются расшифровки выбранной строки заказа, а именно:

* История - список документов, которые являлись регистраторами движений по статусам данной строки;
* Статусы – список конечных статусов, в которых находится данная строка, например, при частичной отгрузке, будет два статуса «Товар отгружен» и «Товар на складе продажи».

#### Zeta Web 3.x



Основное место работы со статусной системой, это **раздел «Представление статусов строк заказа»** **(Zeta Web → Панель управления "Настройки" →** закладка **Заказы и статусы).**

В данный журнал фиксируются движения строк заказов в разрезе номенклатуры, характеристики и цены, а также нажатием на "**Открыть движения строки заказа"** происходит переход в регистр, где отражены все движения по заказу в плюс/минус.

![](<../.gitbook/assets/Image 144.png>)

Помимо анализа движений строк заказа, в  форме также доступен ввод корректировок, нажатием на кнопку **"Ввести корректировку строки заказа"** в верхней панели меню.

### Статусы и документы, которыми производится движение:

**01. Товар в корзине на сайте** – данный статус выставляется заказу, оформленному из системы зета веб, который еще не прошел подтверждение

**02. Приостановлен (ожидает оплаты)** – заказы, которые на сайте в статусе приостановлен

**03. Товар под заказ (нет. на скл. и у пост.)** – строка заказ покупателя, у которой не задано резервирование товара по складу

**04. Товар к перемещению на склад выдачи** – строка заказа с указанием размещения в табличной части, размещение должно отличаться от склада указанного в шапке заказа&#x20;

**05. Товар в пути с др. склада/филиала** -  в данный статус строку заказа переводит документ Расходный ордер на товары

**06. Товар в пути от поставщика** – данный статус устанавливается, если в заказе покупателя по строке указано размещение в заказе поставщика.

**07. Зарезервирован на складе выдачи** -  статус ставится строке, если в документе «Заказ покупателя» склад резервирования (склад в ТЧ) и склад отгрузки (в шапке) совпадают, так же в данный статус переводит документ «Приходный ордер на товары», и документ «Перемещение товаров» с видом операции товары.

**08. Отказ поставщика** – статус устанавливается, если произошла отмена заказа поставщику, веден документ «Корректировка заказа поставщику» или в табличной части заказа поставщику проставлено «Кол-во отказано». Поддерживается только при работе со Виртуальным складом v 1.0 (встроенный в УТ 10.3). Не поддерживается в Zeta Web начиная с релиза 2.5.0.0

**09. Аннулирован клиентом** – строка заказа, по которой произведен отказ клиента – вводится документом корректировка заказа.

**10. Товар отгружен** -  в данный статус переводит документ «Реализация товаров и услуг»

**20. Проблемные заказы** -  попадают строки, по которым нарушена последовательность статусов

**Подтвержденный резерв** – строка переходит в данный статус, когда введен документ «Перемещение товаров» по ордерной схеме

### Основные ошибки (проблемные заказы):

* Пропущен один или несколько статусов;
* Нарушена последовательность документов;
* Не корректно указано размещение в документах;
* Не правильно указан способ списания в документах реализации;
* Задвоился документ движение строк заказов по одной строке и статусу – происходит, когда по одной строке запускают и регламентное задание, и служебную обработку движения по статусам.

### Реализация в системе 1С: Предприятие

**В конфигурацию Управление торговлей 10.3 для работы со статусами добавлены:**

* Справочник «СтрокиЗаказа»;
* Справочник «СтатусыСтрокиЗаказа»;
* Последовательность «Статусы»;
* Документ «ДвижениеСтрокЗаказов» - документ, который переводит строку из статуса в статус;
* Обработка «ЖурналСтрокЗаказов» - интерфейс для работы со статусами;
* Регистр сведений «СтрокиЗаказовЖурнал» - необходим для быстрой и удобной работы с текущими статусами строк;
* Регистр накопления «СтатусыСтрокЗаказа» -  необходим для учета количества;
* Общий модуль «УправлениеСтатусамиСтрокЗаказов»;
* Подписка на событие «СтатусыСтрокЗаказовПередЗаписьюДокумента»;
* Подписка на событие «СтатусыСтрокЗаказовПриЗаписиДокумента»;
* Регламентное задание «СтатусыСтрокЗаказов»;
* Регламентное задание «ЗетаОповещениеПоСтрокамЗаказов».

{% hint style="info" %}
**Принцип работы системы:**

1. При проведении документа, система регистрирует его в последовательности статусов;
2. Регламентное событие, на основании этого документа создает или перезаполняет документ «движение строк заказов», в т.ч. указывается текущий статус и новый;
3. Обновляется представление статусов строкой в регистре сведений.
{% endhint %}
